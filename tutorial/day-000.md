下面给你一套 **Day 0（环境搭建 & 验证）** 的“照着做就能跑起来”的步骤，目标是：在 Ubuntu 里能顺利跑 `ros2` 命令、能跑通 `turtlesim`（或最小例子），并把全过程留痕到 `robotics-week0-notes/SETUP.md`。

我默认你用 **Ubuntu 22.04 LTS + ROS 2 Humble（稳定、资料多）**。ROS 官方安装页对应关系也能对上：Humble 对 Ubuntu 22.04；Jazzy 对 Ubuntu 24.04。([ROS Docs][1])
ROS 2 Debian 包安装步骤以官方 Humble 文档为准。([ROS Docs][2])
`turtlesim` 教程也在官方 Humble 文档里。([ROS Docs][3])

---

## 0) 路线选择：VM 还是原生双系统？

### 方案 A：VM（推荐，最省事、可回滚）

适合学习期：随时快照、不会影响 macOS。

**VM 建议配置**

* CPU：4 核起（能给 6–8 更舒服）
* 内存：8GB 起（16GB 更舒服）
* 磁盘：40GB 起（建议 60GB）
* 网络：NAT/Bridged 都行（默认 NAT 足够）
* 显示：开 3D 加速（如果你的 VM 软件支持）

可选 VM 软件：Parallels / VMware Fusion / UTM（免费但可能折腾一点）

> 你是 Intel Mac（从浏览器 UA 看是 Intel），跑 x86_64 Ubuntu 很顺。

### 方案 B：原生（双系统/独立安装）

性能最好但折腾大、风险高（分区、引导）。学习 Day0 不建议。

下面我按 **方案 A：VM** 写步骤；你如果坚持原生，后面 ROS 安装步骤完全一样。

---

## 1) 安装 Ubuntu 22.04 LTS（VM 内）

1. 下载 Ubuntu 22.04 LTS ISO（桌面版）。
2. 新建 VM，选择从 ISO 启动安装。
3. 安装过程中建议：

   * 用户名随意（比如 `weiran`）
   * 勾选 “Install third-party software …”（有助于显卡/媒体等驱动）
4. 装完进系统后先更新一轮：

```bash
sudo apt update
sudo apt upgrade -y
sudo reboot
```

---

## 2) 安装常用开发工具（git / pip / build 工具）

```bash
sudo apt update
sudo apt install -y \
  git \
  python3-pip \
  python3-venv \
  curl \
  wget \
  build-essential \
  cmake \
  gdb \
  pkg-config \
  lsb-release \
  software-properties-common
```

验证：

```bash
git --version
python3 --version
pip3 --version
```

---

## 3) 安装 ROS 2 Humble（Ubuntu 22.04，Deb 包方式）

> 下面步骤跟 ROS 官方 Humble “Ubuntu (deb packages)” 安装说明一致（加了必要解释）。([ROS Docs][2])

### 3.1 设置 locale（避免后续工具报编码问题）

```bash
sudo apt install -y locales
sudo locale-gen en_US en_US.UTF-8
sudo update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8
export LANG=en_US.UTF-8
```

### 3.2 启用 Ubuntu universe 源

```bash
sudo apt install -y software-properties-common
sudo add-apt-repository universe
```

### 3.3 添加 ROS 2 apt 源与 key（按官方流程）

（不同时间官方可能更新具体 key/包名，但官方文档永远是准的；遇到 key 问题就去 Humble 官方安装页对照）([ROS Docs][2])

执行（常见写法）：

```bash
sudo apt update
sudo apt install -y curl ca-certificates gnupg

sudo curl -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key \
  -o /usr/share/keyrings/ros-archive-keyring.gpg

echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] \
http://packages.ros.org/ros2/ubuntu $(. /etc/os-release && echo $UBUNTU_CODENAME) main" | \
sudo tee /etc/apt/sources.list.d/ros2.list > /dev/null
```

然后：

```bash
sudo apt update
```

### 3.4 安装 ROS 2（建议 desktop，含 turtlesim/rqt 等学习必备）

```bash
sudo apt install -y ros-humble-desktop
```

（如果你只想最小安装：`ros-humble-ros-base`，但 Day0 做 demo 反而更麻烦。）

---

## 4) 配置 shell：每次打开终端自动 source ROS 环境

先验证手动 source：

```bash
source /opt/ros/humble/setup.bash
ros2 --help
```

如果 `ros2` 能出帮助信息，说明 OK。

把它写进 `~/.bashrc`（Ubuntu 默认 bash）：

```bash
echo "source /opt/ros/humble/setup.bash" >> ~/.bashrc
source ~/.bashrc
```

可选：加一些常用 alias（不是必须）：

```bash
echo "alias cw='cd ~/ws'" >> ~/.bashrc
echo "alias cs='cd ~/ws/src'" >> ~/.bashrc
source ~/.bashrc
```

---

## 5) 安装 colcon（构建 ROS workspace 常用）

常见安装方式：

* apt：`python3-colcon-common-extensions`
* 或 pip：`colcon-common-extensions`（当 apt 依赖冲突时很好用）([Colcon Documentation][4])

先试 apt（推荐）：

```bash
sudo apt install -y python3-colcon-common-extensions
colcon --help
```

如果你遇到依赖装不上（少见但有人碰到），用 pip 兜底：

```bash
python3 -m pip install -U colcon-common-extensions
~/.local/bin/colcon --help
```

若用 pip 安装，建议把 `~/.local/bin` 加进 PATH（通常系统会自动处理；没处理就手动加）：

```bash
echo 'export PATH="$HOME/.local/bin:$PATH"' >> ~/.bashrc
source ~/.bashrc
```

---

## 6) VS Code（可选）

### 方案 A：Ubuntu Software / Snap（最省事）

```bash
sudo snap install --classic code
```

然后装扩展：

* ROS（Microsoft / community 的 ROS 插件）
* Python
* C/C++

---

## 7) 跑 Demo：turtlesim（最快验证“ROS 2 能跑”）

> 官方 turtlesim 教程在这里（Humble）。([ROS Docs][3])

确保你已经 source 过（或已写进 `.bashrc`）：

```bash
ros2 --version
```

开 2 个终端：

**终端 A：启动 turtlesim**

```bash
ros2 run turtlesim turtlesim_node
```

**终端 B：键盘控制**

```bash
ros2 run turtlesim turtle_teleop_key
```

你应该能看到窗口里乌龟动起来。

再做两个“确认式”检查：

```bash
ros2 node list
ros2 topic list
ros2 topic echo /turtle1/pose
```

---

## 8) 再跑一个“最小例子”（可选但很推荐）：官方 demo_nodes_cpp

```bash
# 终端 A
ros2 run demo_nodes_cpp talker

# 终端 B
ros2 run demo_nodes_cpp listener
```

你会看到 listener 持续收到 talker 的消息。

---

## 9) 留痕：创建 repo + 写 SETUP.md + commit

在 Ubuntu 里（建议放在 home 下）：

```bash
mkdir -p ~/projects
cd ~/projects
mkdir robotics-week0-notes
cd robotics-week0-notes
git init
```

新建 `SETUP.md`：

````bash
cat > SETUP.md << 'EOF'
# Robotics Week 0 - Setup Notes

## Goal
- Able to run `ros2` commands without errors
- Able to run a ROS 2 demo (turtlesim / minimal pub-sub)

## Machine / Environment
- Host: macOS (Intel Mac)
- Ubuntu: 22.04 LTS (VM)
- VM software: <Fill: Parallels / VMware / UTM>
- VM resources: <CPU cores>, <RAM GB>, <Disk GB>

## Installed Tooling
- git: `git --version`
- python3/pip: `python3 --version`, `pip3 --version`
- build tools: build-essential, cmake, etc.
- colcon: `colcon --help`
- (optional) VS Code: `code --version`

## ROS 2 Installation
- ROS 2 distro: Humble (Ubuntu 22.04)
- Install method: Debian packages (apt)

### Key commands executed
```bash
sudo apt update && sudo apt upgrade -y
sudo apt install -y locales
sudo locale-gen en_US en_US.UTF-8
sudo update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8

sudo add-apt-repository universe

# Add ROS 2 apt repo + key (see ROS docs)
# ...
sudo apt update
sudo apt install -y ros-humble-desktop

echo "source /opt/ros/humble/setup.bash" >> ~/.bashrc
source ~/.bashrc

sudo apt install -y python3-colcon-common-extensions
````

## Verification (Must Pass)

### 1) ros2 CLI

```bash
ros2 --help
ros2 pkg list | head
```

### 2) turtlesim

Terminal A:

```bash
ros2 run turtlesim turtlesim_node
```

Terminal B:

```bash
ros2 run turtlesim turtle_teleop_key
```

Checks:

```bash
ros2 node list
ros2 topic list
ros2 topic echo /turtle1/pose
```

### 3) minimal pub/sub (optional)

```bash
ros2 run demo_nodes_cpp talker
ros2 run demo_nodes_cpp listener
```

## Pitfalls / Fixes

* <Write what went wrong and how you fixed it>
* Examples:

  * apt key / repo issues
  * forgetting to `source /opt/ros/humble/setup.bash`
  * colcon install dependency issues (apt vs pip)
    EOF

````

然后 commit：
```bash
git add SETUP.md
git commit -m "Day 0: Ubuntu + ROS2 Humble setup and verification"
````

（如果你要建 GitHub repo：去 GitHub 新建一个同名 repo，然后按它提示加 remote push。）

---

## Day0 完成标准（你对照打勾）

* [ ] 打开终端 `ros2 --help` 正常
* [ ] `turtlesim_node` 能启动，`teleop` 能控制
* [ ] `ros2 node list / topic list` 能看到节点和 topic
* [ ] `robotics-week0-notes/SETUP.md` 写完并 commit

---

如果你把你用的 VM 软件（Parallels / VMware / UTM）和你现在卡在哪一步（比如 apt key、`ros2` 找不到、turtlesim 打不开窗口）贴一段报错，我可以直接按你的报错把 `SETUP.md` 里的 “Pitfalls / Fixes” 帮你补成可复用的排障手册。

[1]: https://docs.ros.org/en/humble/Installation.html?utm_source=chatgpt.com "Installation — ROS 2 Documentation: Humble documentation"
[2]: https://docs.ros.org/en/humble/Installation/Ubuntu-Install-Debs.html?utm_source=chatgpt.com "Ubuntu (deb packages) — ROS 2 Documentation"
[3]: https://docs.ros.org/en/humble/Tutorials/Beginner-CLI-Tools/Introducing-Turtlesim/Introducing-Turtlesim.html?utm_source=chatgpt.com "Using turtlesim, ros2, and rqt"
[4]: https://colcon.readthedocs.io/en/released/user/installation.html?utm_source=chatgpt.com "Installation — colcon documentation - Read the Docs"
